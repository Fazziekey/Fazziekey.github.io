<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>蒙特卡洛搜索实现黑白棋 | 摸黑干活</title><meta name="keywords" content="Monte Carlo search"><meta name="author" content="Fazzie"><meta name="copyright" content="Fazzie"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="问题重述黑白棋简介黑白棋(Reversi),也叫翻转棋，是一款经典的策略游戏。 一般棋子双面为黑白两色，故称“黑白棋”。因为行棋之时将对方棋子翻转，则变为己方棋子，故又称“翻转棋” (Reversi) 。 它使用 8x8 的棋盘，由两人执黑子和白子轮流下棋，最后子多方为胜方。 游戏规则开始时，黑棋位于D5和E4,白棋位于D4和E5.一个合法的落子：  在空处落子、并翻转对手一个或多个棋子 新落子位">
<meta property="og:type" content="article">
<meta property="og:title" content="蒙特卡洛搜索实现黑白棋">
<meta property="og:url" content="https://fazziekey.github.io/2021/05/10/black-white-cheese/index.html">
<meta property="og:site_name" content="摸黑干活">
<meta property="og:description" content="问题重述黑白棋简介黑白棋(Reversi),也叫翻转棋，是一款经典的策略游戏。 一般棋子双面为黑白两色，故称“黑白棋”。因为行棋之时将对方棋子翻转，则变为己方棋子，故又称“翻转棋” (Reversi) 。 它使用 8x8 的棋盘，由两人执黑子和白子轮流下棋，最后子多方为胜方。 游戏规则开始时，黑棋位于D5和E4,白棋位于D4和E5.一个合法的落子：  在空处落子、并翻转对手一个或多个棋子 新落子位">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg">
<meta property="article:published_time" content="2021-05-10T14:31:44.000Z">
<meta property="article:modified_time" content="2025-11-24T06:55:57.488Z">
<meta property="article:author" content="Fazzie">
<meta property="article:tag" content="Monte Carlo search">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://fazziekey.github.io/2021/05/10/black-white-cheese/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-11-24 14:55:57'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.2"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/head.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">69</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">41</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/index.html"><i class="fa-fw fas fas fa-id-card"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="/CV/Maqianli_CV_EN.html"><i class="fa-fw fas fa-file-alt"></i><span> CV</span></a></div><div class="menus_item"><a class="site-page" href="/nn/"><i class="fa-fw fas fa-network-wired"></i><span> Super Intelligence</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">摸黑干活</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/index.html"><i class="fa-fw fas fas fa-id-card"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="/CV/Maqianli_CV_EN.html"><i class="fa-fw fas fa-file-alt"></i><span> CV</span></a></div><div class="menus_item"><a class="site-page" href="/nn/"><i class="fa-fw fas fa-network-wired"></i><span> Super Intelligence</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">蒙特卡洛搜索实现黑白棋</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-05-10T14:31:44.000Z" title="发表于 2021-05-10 22:31:44">2021-05-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-11-24T06:55:57.488Z" title="更新于 2025-11-24 14:55:57">2025-11-24</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E3%80%8A%E7%82%BC%E9%87%91%E6%9C%AF%E5%A3%AB%E4%BF%AE%E7%82%BC%E6%89%8B%E5%86%8C%E3%80%8B/">《炼金术士修炼手册》</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="问题重述"><a href="#问题重述" class="headerlink" title="问题重述"></a>问题重述</h1><h2 id="黑白棋简介"><a href="#黑白棋简介" class="headerlink" title="黑白棋简介"></a>黑白棋简介</h2><p>黑白棋(Reversi),也叫翻转棋，是一款经典的策略游戏。</p>
<p>一般棋子双面为黑白两色，故称“黑白棋”。因为行棋之时将对方棋子翻转，则变为己方棋子，故又称“翻转棋” (Reversi) 。</p>
<p>它使用 8x8 的棋盘，由两人执黑子和白子轮流下棋，最后子多方为胜方。</p>
<h3 id="游戏规则"><a href="#游戏规则" class="headerlink" title="游戏规则"></a>游戏规则</h3><p>开始时，黑棋位于D5和E4,白棋位于D4和E5.<br>一个合法的落子：</p>
<ul>
<li>在空处落子、并翻转对手一个或多个棋子</li>
<li>新落子位置必须在可以夹住对方的位置上、对方被夹住的棋子翻转。可以是横着夹、竖着夹、对角线夹</li>
<li>任何被夹住的棋子必须被反过来<br>如果一方没有合法棋步，也就是无论他下在哪里，都无法翻转对方的棋子了，这一轮只能弃权<br>棋局持续知道棋盘填满或双方都没有合法棋步可下<br>如果一方落子时间超过1min，或者连续三次落子不合法，则判断该方失败</li>
</ul>
<h2 id="棋盘类介绍"><a href="#棋盘类介绍" class="headerlink" title="棋盘类介绍"></a>棋盘类介绍</h2><h3 id="初始化棋盘"><a href="#初始化棋盘" class="headerlink" title="初始化棋盘"></a>初始化棋盘</h3><p>棋盘规格是 8x8，’X’ 代表黑棋，’O’ 代表白棋，’.’ 代表未落子状态。</p>
<p>棋盘初始化 - 利用 Board 类（board.py）中的 <code>display()</code> 方法展示棋盘：</p>
<h3 id="导入棋盘文件"><a href="#导入棋盘文件" class="headerlink" title="导入棋盘文件"></a>导入棋盘文件</h3><pre><code>from board import Board
</code></pre><h4 id="初始化棋盘-1"><a href="#初始化棋盘-1" class="headerlink" title="初始化棋盘"></a>初始化棋盘</h4><p>board = Board()</p>
<h1 id="打印初始化棋盘"><a href="#打印初始化棋盘" class="headerlink" title="打印初始化棋盘"></a>打印初始化棋盘</h1><pre><code>board.display()
</code></pre><h3 id="棋盘与坐标之间的关系"><a href="#棋盘与坐标之间的关系" class="headerlink" title="棋盘与坐标之间的关系"></a>棋盘与坐标之间的关系</h3><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">A</th>
<th style="text-align:center">B</th>
<th style="text-align:center">C</th>
<th style="text-align:center">D</th>
<th style="text-align:center">E</th>
<th style="text-align:center">F</th>
<th style="text-align:center">G</th>
<th style="text-align:center">H</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">(0,0)</td>
<td style="text-align:center">(0,1)</td>
<td style="text-align:center">(0,2)</td>
<td style="text-align:center">(0,3)</td>
<td style="text-align:center">(0,4)</td>
<td style="text-align:center">(0,5)</td>
<td style="text-align:center">(0,6)</td>
<td style="text-align:center">(0,7)</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">(1,0)</td>
<td style="text-align:center">(1,1)</td>
<td style="text-align:center">(1,2)</td>
<td style="text-align:center">(1,3)</td>
<td style="text-align:center">(1,4)</td>
<td style="text-align:center">(1,5)</td>
<td style="text-align:center">(1,6)</td>
<td style="text-align:center">(1,7)</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">(2,0)</td>
<td style="text-align:center">(2,1)</td>
<td style="text-align:center">(2,2)</td>
<td style="text-align:center">(2,3)</td>
<td style="text-align:center">(2,4)</td>
<td style="text-align:center">(2,5)</td>
<td style="text-align:center">(2,6)</td>
<td style="text-align:center">(2,7)</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">(3,0)</td>
<td style="text-align:center">(3,1)</td>
<td style="text-align:center">(3,2)</td>
<td style="text-align:center">(3,3)</td>
<td style="text-align:center">(3,4)</td>
<td style="text-align:center">(3,5)</td>
<td style="text-align:center">(3,6)</td>
<td style="text-align:center">(3,7)</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">(4,0)</td>
<td style="text-align:center">(4,1)</td>
<td style="text-align:center">(4,2)</td>
<td style="text-align:center">(4,3)</td>
<td style="text-align:center">(4,4)</td>
<td style="text-align:center">(4,5)</td>
<td style="text-align:center">(4,6)</td>
<td style="text-align:center">(4,7)</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">(5,0)</td>
<td style="text-align:center">(5,1)</td>
<td style="text-align:center">(5,2)</td>
<td style="text-align:center">(5,3)</td>
<td style="text-align:center">(5,4)</td>
<td style="text-align:center">(5,5)</td>
<td style="text-align:center">(5,6)</td>
<td style="text-align:center">(5,7)</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">(6,0)</td>
<td style="text-align:center">(6,1)</td>
<td style="text-align:center">(6,2)</td>
<td style="text-align:center">(6,3)</td>
<td style="text-align:center">(6,4)</td>
<td style="text-align:center">(6,5)</td>
<td style="text-align:center">(6,6)</td>
<td style="text-align:center">(6,7)</td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center">(7,0)</td>
<td style="text-align:center">(7,1)</td>
<td style="text-align:center">(7,2)</td>
<td style="text-align:center">(7,3)</td>
<td style="text-align:center">(7,4)</td>
<td style="text-align:center">(7,5)</td>
<td style="text-align:center">(7,6)</td>
<td style="text-align:center">(7,7)</td>
</tr>
</tbody>
</table>
</div>
<p>棋盘坐标 E4, 转化为坐标形式就是 (3, 4), 坐标数值大小是从 0 开始，到 7 结束。  </p>
<p>Board 类中，提供以上两种坐标的转化方法：</p>
<ul>
<li><code>board_num(action)</code>: 棋盘坐标转化为数字坐标。<ul>
<li>action: 棋盘坐标，e.g. ‘G6’</li>
<li>返回值: 数字坐标，e.g. (5, 6)</li>
</ul>
</li>
<li><code>num_board(action)</code>: 数字坐标转化为棋盘坐标。<ul>
<li>action: 数字坐标，e.g. (2, 7)</li>
<li>返回值: 棋盘坐标，e.g. ‘H3’</li>
</ul>
</li>
</ul>
<h3 id="查看坐标-4-3-在棋盘上的位置"><a href="#查看坐标-4-3-在棋盘上的位置" class="headerlink" title="查看坐标 (4,3) 在棋盘上的位置"></a>查看坐标 (4,3) 在棋盘上的位置</h3><pre><code>position = (4, 3)
print(board.num_board(position))
</code></pre><h3 id="查看棋盘位置-‘G2’-的坐标"><a href="#查看棋盘位置-‘G2’-的坐标" class="headerlink" title="查看棋盘位置 ‘G2’ 的坐标"></a>查看棋盘位置 ‘G2’ 的坐标</h3><pre><code>position = &#39;G2&#39;
print(board.board_num(position))
</code></pre><h3 id="Board-类中比较重要的方法"><a href="#Board-类中比较重要的方法" class="headerlink" title="Board 类中比较重要的方法"></a>Board 类中比较重要的方法</h3><ul>
<li><code>get_legal_actions(color)</code>： 根据黑白棋的规则获取 color 方棋子的合法落子坐标，用 <code>list()</code> 方法可以获取所有的合法坐标。<ul>
<li>color: 下棋方，’X’ - 黑棋，’O’ - 白棋</li>
<li>返回值: 合法的落子坐标列表  </li>
</ul>
</li>
</ul>
<h3 id="棋盘初始化后，黑方可以落子的位置"><a href="#棋盘初始化后，黑方可以落子的位置" class="headerlink" title="棋盘初始化后，黑方可以落子的位置"></a>棋盘初始化后，黑方可以落子的位置</h3><pre><code>print(list(board.get_legal_actions(&#39;X&#39;)))
</code></pre><ul>
<li><code>_move(action, color)</code>：  根据 color 落子坐标 action 获取翻转棋子的坐标。  <ul>
<li>action: 落子的坐标，e.g. ‘C4’</li>
<li>color: 下棋方，’X’ - 黑棋，’O’ - 白棋</li>
<li>返回值: 反转棋子棋盘坐标列表</li>
</ul>
</li>
</ul>
<h3 id="打印初始化后的棋盘"><a href="#打印初始化后的棋盘" class="headerlink" title="打印初始化后的棋盘"></a>打印初始化后的棋盘</h3><pre><code>board.display()
</code></pre><h4 id="假设现在黑棋下棋，可以落子的位置有：-‘D3’-‘C4’-‘F5’-‘E6’-，"><a href="#假设现在黑棋下棋，可以落子的位置有：-‘D3’-‘C4’-‘F5’-‘E6’-，" class="headerlink" title="假设现在黑棋下棋，可以落子的位置有：[‘D3’, ‘C4’, ‘F5’, ‘E6’]，"></a>假设现在黑棋下棋，可以落子的位置有：[‘D3’, ‘C4’, ‘F5’, ‘E6’]，</h4><h4 id="黑棋落子-D3-则白棋被翻转的棋子是-D4。"><a href="#黑棋落子-D3-则白棋被翻转的棋子是-D4。" class="headerlink" title="黑棋落子 D3 , 则白棋被翻转的棋子是 D4。"></a>黑棋落子 D3 , 则白棋被翻转的棋子是 D4。</h4><h4 id="表示黑棋"><a href="#表示黑棋" class="headerlink" title="表示黑棋"></a>表示黑棋</h4><pre><code>color = &#39;X&#39; 
</code></pre><h4 id="落子坐标"><a href="#落子坐标" class="headerlink" title="落子坐标"></a>落子坐标</h4><pre><code>action = &#39;D3&#39; 
</code></pre><h3 id="打印白方被翻转的棋子位置"><a href="#打印白方被翻转的棋子位置" class="headerlink" title="打印白方被翻转的棋子位置"></a>打印白方被翻转的棋子位置</h3><pre><code>print(board._move(action,color))
</code></pre><h3 id="打印棋盘"><a href="#打印棋盘" class="headerlink" title="打印棋盘"></a>打印棋盘</h3><pre><code>board.display()
</code></pre><h2 id="Game-类"><a href="#Game-类" class="headerlink" title="Game 类"></a>Game 类</h2><p>该类主要实现黑白棋的对弈，已经实现随机玩家和人类玩家，现在可以来对弈一下。<br>Game 类（game.py）的主要方法和属性:  </p>
<ul>
<li>属性：<ul>
<li><code>self.board</code>：棋盘</li>
<li><code>self.current_player</code>：定义当前的下棋一方，考虑游戏还未开始我们定义为 None</li>
<li><code>self.black_player</code>：定义黑棋玩家 black_player</li>
<li><code>self.white_player</code>：定义白棋玩家 white_player</li>
</ul>
</li>
</ul>
<ul>
<li>方法：   <ul>
<li><code>switch_player()</code>：下棋时切换玩家  </li>
<li><code>run()</code>：黑白棋游戏的主程序  </li>
</ul>
</li>
</ul>
<h1 id="设计思想"><a href="#设计思想" class="headerlink" title="设计思想"></a>设计思想</h1><h2 id="蒙特卡洛方法-Monte-Carlo-method"><a href="#蒙特卡洛方法-Monte-Carlo-method" class="headerlink" title="蒙特卡洛方法(Monte Carlo method)"></a>蒙特卡洛方法(Monte Carlo method)</h2><p>MCTS是一种“统计模拟方法”。20世纪40年代，为建造核武器，冯.诺伊曼等人发明了该算法。因赌城蒙特卡洛而得名，暗示其以概率作为算法的基础。<br>假设我们要计算一个不规则形状的面积，我们只需在包含这个不规则形状的矩形内，随机的掷出一个点，每掷出一个点，则N+1，如果这个点在不规则图形内则W+1。落入不规则图形的概率即为 W/N。当掷出足够多的点之后，我们可以认为：不规则图形面积＝矩形面积＊W/N。</p>
<h2 id="UCT（信心上限树算法）"><a href="#UCT（信心上限树算法）" class="headerlink" title="UCT（信心上限树算法）"></a>UCT（信心上限树算法）</h2><p>UCT 算法是蒙特卡洛方法的一种改进，比蒙特卡洛方法更容易得 到最优解，其基本结构和蒙特卡洛方法相同，主要分为四个步骤：选 择 (Selection) ， 拓 展 (Expansion) ， 模 拟 (Simulation) 和 反 向 传 播 (Backpropagation)</p>
<p><strong>其价值函数定义为</strong></p>
<script type="math/tex; mode=display">
value = child.reward / child.visits + c\sqrt{\frac{2In(node.visits)}{child.visits}}</script><p><img src="https://pic4.zhimg.com/80/v2-16cafcfda07f07733d2a2326500b6bd7_720w.jpg" alt="image"></p>
<h3 id="选择-Selection"><a href="#选择-Selection" class="headerlink" title="选择(Selection)"></a>选择(Selection)</h3><p>在选择阶段，需要从根节点，也就是要做决策的局面R出发向下选择出一个最急迫需要被拓展的节点N，局面R是是每一次迭代中第一个被检查的节点；对于被检查的局面而言，他可能有三种可能：</p>
<ul>
<li>该节点所有可行动作都已经被拓展过</li>
<li>该节点有可行动作还未被拓展过</li>
<li>这个节点游戏已经结束了(例如已经连成五子的五子棋局面)</li>
</ul>
<p>对于这三种可能：</p>
<ul>
<li>如果所有可行动作都已经被拓展过了，那么我们将使用UCB公式计算该节点所有子节点的UCB值，并找到值最大的一个子节点继续检查。反复向下迭代。</li>
<li>如果被检查的局面依然存在没有被拓展的子节点(例如说某节点有20个可行动作，但是在搜索树中才创建了19个子节点)，那么我们认为这个节点就是本次迭代的的目标节点N，并找出N还未被拓展的动作A。执行步骤[2]</li>
<li>如果被检查到的节点是一个游戏已经结束的节点。那么从该节点直接执行步骤{4]。<br>每一个被检查的节点的被访问次数在这个阶段都会自增。在反复的迭代之后，我们将在搜索树的底端找到一个节点，来继续后面的步骤。</li>
</ul>
<h3 id="拓展-Expansion"><a href="#拓展-Expansion" class="headerlink" title="拓展(Expansion)"></a>拓展(Expansion)</h3><p>在选择阶段结束时候，我们查找到了一个最迫切被拓展的节点N，以及他一个尚未拓展的动作A。在搜索树中创建一个新的节点Nn作为N的一个新子节点。Nn的局面就是节点N在执行了动作A之后的局面。</p>
<h3 id="模拟-Simulation"><a href="#模拟-Simulation" class="headerlink" title="模拟(Simulation)"></a>模拟(Simulation)</h3><p>为了让Nn得到一个初始的评分。我们从Nn开始，让游戏随机进行，直到得到一个游戏结局，这个结局将作为Nn的初始评分。一般使用胜利/失败来作为评分，只有1或者0。</p>
<h3 id="反向传播-Back-Propagation"><a href="#反向传播-Back-Propagation" class="headerlink" title="反向传播(Back Propagation)"></a>反向传播(Back Propagation)</h3><p>在Nn的模拟结束之后，它的父节点N以及从根节点到N的路径上的所有节点都会根据本次模拟的结果来添加自己的累计评分。如果在[1]的选择中直接发现了一个游戏结局的话，根据该结局来更新评分。每一次迭代都会拓展搜索树，随着迭代次数的增加，搜索树的规模也不断增加。当到了一定的迭代次数或者时间之后结束，选择根节点下最好的子节点作为本次决策的结果。</p>
<h2 id="MCT伪代码"><a href="#MCT伪代码" class="headerlink" title="MCT伪代码"></a>MCT伪代码</h2><p><img src="https://cdn.jsdelivr.net/gh/Fazziekey/image-bed/img/20210510192520.png" alt=""></p>
<h1 id="代码内容"><a href="#代码内容" class="headerlink" title="代码内容"></a>代码内容</h1><h2 id="节点类的定义"><a href="#节点类的定义" class="headerlink" title="节点类的定义"></a>节点类的定义</h2><pre><code>class Node:
    def __init__(self, state, parent=None, action=None, color=&quot;X&quot;):
        self.visits = 0  #访问次数
        self.reward = 0.0 #期望值
        self.state = state #棋盘状态，Broad类
        self.children = [] #子节点
        self.parent = parent #父节点
        self.action = action #从父节点转移到本节点采取的动作
        self.color = color #该节点玩家颜色

    # 增加子节点
    def add_child(self, child_state, action, color):
        child_node = Node(child_state, parent=self, action=action, color=color)
        self.children.append(child_node)

    # 判断是否完全展开
    def fully_expanded(self):
        action = list(self.state.get_legal_actions(self.color))
        if len(self.children) == len(action):
            return True
        return False
</code></pre><h2 id="AI玩家类的定义"><a href="#AI玩家类的定义" class="headerlink" title="AI玩家类的定义"></a>AI玩家类的定义</h2><pre><code>class AIPlayer:
    &quot;&quot;&quot;
    AI 玩家
    &quot;&quot;&quot;
    step = 0
    def __init__(self, color):
        &quot;&quot;&quot;
        玩家初始化
        :param color: 下棋方，&#39;X&#39; - 黑棋，&#39;O&#39; - 白棋
        &quot;&quot;&quot;
        # 最大迭代次数
        self.max_times = 100
        # 玩家颜色
        self.color = color
        # UCB超参数
        self.SCALAR = 1
</code></pre><h3 id="移动棋子的方法"><a href="#移动棋子的方法" class="headerlink" title="移动棋子的方法"></a>移动棋子的方法</h3><pre><code>def get_move(self, board):
    &quot;&quot;&quot;
    根据当前棋盘状态获取最佳落子位置
    :param board: 棋盘
    :return: action 最佳落子位置, e.g. &#39;A1&#39;
    &quot;&quot;&quot;
    if self.color == &#39;X&#39;:
        player_name = &#39;黑棋&#39;
    else:
        player_name = &#39;白棋&#39;
    print(&quot;请等一会，对方 &#123;&#125;-&#123;&#125; 正在思考中...&quot;.format(player_name, self.color))

    board_state = copy.deepcopy(board)
    root = Node(state=board_state, color=self.color)
    action = self.uct_search(self.max_times, root)

    return action
</code></pre><h3 id="UCT-search的核心框架"><a href="#UCT-search的核心框架" class="headerlink" title="UCT search的核心框架"></a>UCT search的核心框架</h3><pre><code>def uct_search(self, max_times, root):
    &quot;&quot;&quot;
    根据当前棋盘状态获取最佳落子位置
    :param max_times: 最大搜索次数，默认100
    :param root: 根节点
    :return: action 最佳落子位置, e.g. &#39;A1&#39;
    &quot;&quot;&quot;
    for t in range(max_times):
        # print(t)
        leave = self.select_policy(root)
        reward = self.stimulate_policy(leave)
        self.backup(leave, reward)
        best_child = self.ucb(root, 0)
    return best_child.action
</code></pre><h3 id="选择扩展的节点"><a href="#选择扩展的节点" class="headerlink" title="选择扩展的节点"></a>选择扩展的节点</h3><p>在这里对UCT的算法进行了改进，鼓励优先考虑目前期望值较大的节点，有0.5的概率在当前节点存在可扩展节点时选择不扩展</p>
<pre><code>def select_policy(self, node):
    &quot;&quot;&quot;
    选择扩展的节点
    :param node: 根节点，Node 类
    :return: leave，Node 类
    &quot;&quot;&quot;
    while not self.terminal(node.state):
        #node.state.display()
        #print(list(node.state.get_legal_actions(node.color)))
        if len(node.children) == 0:
            new_node = self.expand(node)
            #print(new_node.action)
            return new_node
        elif random.uniform(0, 1) &lt; .5:
            node = self.ucb(node, self.SCALAR)
        else:
            node = self.ucb(node, self.SCALAR)
            if not node.fully_expanded():
                return self.expand(node)
            else:
                node = self.ucb(node, self.SCALAR)
    return node
</code></pre><h3 id="扩展函数"><a href="#扩展函数" class="headerlink" title="扩展函数"></a>扩展函数</h3><pre><code>def expand(self, node):
    &quot;&quot;&quot;
    选择扩展的节点
    :param node: 根节点，Node 类
    :return: leave，Node 类
    &quot;&quot;&quot;
    # 随机选择动作
    action_list = list(node.state.get_legal_actions(node.color))
    # 防止尾盘时出现卡死，没有动作可以选择
    if len(action_list) == 0:
        return node.parent

    action = random.choice(action_list)
    tried_action = [c.action for c in node.children]
    while action in tried_action:
        action = random.choice(action_list)

    # 复制状态并根据动作更新到新状态
    new_state = copy.deepcopy(node.state)
    new_state._move(action, node.color)

    # 确定子节点颜色
    if node.color == &#39;X&#39;:
        new_color = &#39;O&#39;
    else:
        new_color = &#39;X&#39;

    # 新建节点
    node.add_child(new_state, action=action, color=new_color)
    return node.children[-1]
</code></pre><h3 id="ucb选择函数"><a href="#ucb选择函数" class="headerlink" title="ucb选择函数"></a>ucb选择函数</h3><pre><code>def ucb(self, node, scalar):
    &quot;&quot;&quot;
    选择最佳子节点
    :param node: 节点，Node 类
    :param scalar: UCT公式超参数
    :return: best_child:最佳子节点，Node 类
    &quot;&quot;&quot;
    best_score = -float(&#39;inf&#39;)
    best_children = []
    for c in node.children:
        exploit = c.reward / c.visits
        if c.visits == 0:
            best_children = [c]
            break
        explore = math.sqrt(2.0 * math.log(node.visits) / float(c.visits))
        score = exploit + scalar * explore
        if score == best_score:
            best_children.append(c)
        if score &gt; best_score:
            best_children = [c]
            best_score = score
    if len(best_children) == 0:
        return node.parent
    return random.choice(best_children)
</code></pre><h3 id="随机模拟对弈"><a href="#随机模拟对弈" class="headerlink" title="随机模拟对弈"></a>随机模拟对弈</h3><p>在定义期望值时同时考虑了胜负关系和获胜的子数，board.get_winner()会返回胜负关系和获胜子数<br>在这里我们定义获胜积100分，每多赢一个棋子多1分</p>
<script type="math/tex; mode=display">
reward = 100 + difference</script><pre><code>def stimulate_policy(self, node):
    &quot;&quot;&quot;
    随机模拟对弈
    :param node: 节点，Node 类
    :return: reward:期望值
    在定义期望值时同时考虑了胜负关系和获胜的子数，board.get_winner()会返回胜负关系和获胜子数
    在这里我们定义获胜积100分，每多赢一个棋子多1分
    reward = 100 + difference
    &quot;&quot;&quot;
    board = copy.deepcopy(node.state)
    color = node.color
    count = 0
    while not self.terminal(board):
        action_list = list(node.state.get_legal_actions(color))
        if not len(action_list) == 0:
            action = random.choice(action_list)
            board._move(action, color)
            if color == &#39;X&#39;:
                color = &#39;O&#39;
            else:
                color = &#39;X&#39;
        else:
            if color == &#39;X&#39;:
                color = &#39;O&#39;
            else:
                color = &#39;X&#39;
            action_list = list(node.state.get_legal_actions(color))
            action = random.choice(action_list)
            board._move(action, color)
            if color == &#39;X&#39;:
                color = &#39;O&#39;
            else:
                color = &#39;X&#39;
        count = count + 1
        if count &gt;= 10:
            break

    # 价值函数定义
    winner, difference = board.get_winner()
    if winner == 2:
        reward = 0
    elif winner == 1:
        reward = 100 + difference
    else:
        reward = -(100 + difference)

    if self.color == &#39;X&#39;:
        reward = - reward
    return reward
</code></pre><h3 id="反向传播"><a href="#反向传播" class="headerlink" title="反向传播"></a>反向传播</h3><pre><code>def backup(self, node, reward):
    while node is not None:
        node.visits += 1
        if node.parent.color == self.color:
            node.reward += reward
        else:
            node.reward -= reward
        node = node.parent
    return 0
</code></pre><h3 id="判断游戏是否结束"><a href="#判断游戏是否结束" class="headerlink" title="判断游戏是否结束"></a>判断游戏是否结束</h3><pre><code>def terminal(self, state):
    &quot;&quot;&quot;
    判断游戏是否结束
    :return: True/False 游戏结束/游戏没有结束
    &quot;&quot;&quot;

    # 根据当前棋盘，判断棋局是否终止
    # 如果当前选手没有合法下棋的位子，则切换选手；如果另外一个选手也没有合法的下棋位置，则比赛停止。
    b_list = list(state.get_legal_actions(&#39;X&#39;))
    w_list = list(state.get_legal_actions(&#39;O&#39;))

    is_over = len(b_list) == 0 and len(w_list) == 0  # 返回值 True/False

    return is_over
</code></pre><h1 id="实验结果"><a href="#实验结果" class="headerlink" title="实验结果"></a>实验结果</h1><h2 id="初级"><a href="#初级" class="headerlink" title="初级"></a>初级</h2><p><img src="https://cdn.jsdelivr.net/gh/Fazziekey/image-bed/img/20210510215115.png" alt=""></p>
<h2 id="中级"><a href="#中级" class="headerlink" title="中级"></a>中级</h2><p><img src="https://cdn.jsdelivr.net/gh/Fazziekey/image-bed/img/20210510215143.png" alt=""></p>
<h2 id="高级"><a href="#高级" class="headerlink" title="高级"></a>高级</h2><p><img src="https://cdn.jsdelivr.net/gh/Fazziekey/image-bed/img/20210510215134.png" alt=""></p>
<p>在实际实验过程中基本可以碾压对手</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Fazziekey/AI_project/tree/main/black-white-cheese">项目地址</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Fazzie</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://fazziekey.github.io/2021/05/10/black-white-cheese/">https://fazziekey.github.io/2021/05/10/black-white-cheese/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://Fazziekey.github.io" target="_blank">摸黑干活</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Monte-Carlo-search/">Monte Carlo search</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/05/27/Eigenface/"><img class="prev-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Eigenface</div></div></a></div><div class="next-post pull-right"><a href="/2021/05/01/experience-of-meeting/"><img class="next-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">算法岗白给面经整理</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/head.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Fazzie</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">69</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">41</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Fazziekey"><i class="fab fa-github"></i><span>Fork Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:3180104413@zju.edu.cn" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://www.linkedin.com/in/qianli-ma-313272207/" target="_blank" title=""><i class="fab fa-linkedin"></i></a><a class="social-icon" href="https://www.zhihu.com/people/fazzie" target="_blank" title=""><i class="fab fa-zhihu"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">talk is cheap, let's go fish</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E9%87%8D%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">问题重述</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%BB%91%E7%99%BD%E6%A3%8B%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.</span> <span class="toc-text">黑白棋简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%B8%E6%88%8F%E8%A7%84%E5%88%99"><span class="toc-number">1.1.1.</span> <span class="toc-text">游戏规则</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A3%8B%E7%9B%98%E7%B1%BB%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.2.</span> <span class="toc-text">棋盘类介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E6%A3%8B%E7%9B%98"><span class="toc-number">1.2.1.</span> <span class="toc-text">初始化棋盘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E6%A3%8B%E7%9B%98%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.2.</span> <span class="toc-text">导入棋盘文件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E6%A3%8B%E7%9B%98-1"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">初始化棋盘</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%89%93%E5%8D%B0%E5%88%9D%E5%A7%8B%E5%8C%96%E6%A3%8B%E7%9B%98"><span class="toc-number">2.</span> <span class="toc-text">打印初始化棋盘</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%8B%E7%9B%98%E4%B8%8E%E5%9D%90%E6%A0%87%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">2.0.1.</span> <span class="toc-text">棋盘与坐标之间的关系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%9D%90%E6%A0%87-4-3-%E5%9C%A8%E6%A3%8B%E7%9B%98%E4%B8%8A%E7%9A%84%E4%BD%8D%E7%BD%AE"><span class="toc-number">2.0.2.</span> <span class="toc-text">查看坐标 (4,3) 在棋盘上的位置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E6%A3%8B%E7%9B%98%E4%BD%8D%E7%BD%AE-%E2%80%98G2%E2%80%99-%E7%9A%84%E5%9D%90%E6%A0%87"><span class="toc-number">2.0.3.</span> <span class="toc-text">查看棋盘位置 ‘G2’ 的坐标</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Board-%E7%B1%BB%E4%B8%AD%E6%AF%94%E8%BE%83%E9%87%8D%E8%A6%81%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">2.0.4.</span> <span class="toc-text">Board 类中比较重要的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%8B%E7%9B%98%E5%88%9D%E5%A7%8B%E5%8C%96%E5%90%8E%EF%BC%8C%E9%BB%91%E6%96%B9%E5%8F%AF%E4%BB%A5%E8%90%BD%E5%AD%90%E7%9A%84%E4%BD%8D%E7%BD%AE"><span class="toc-number">2.0.5.</span> <span class="toc-text">棋盘初始化后，黑方可以落子的位置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%93%E5%8D%B0%E5%88%9D%E5%A7%8B%E5%8C%96%E5%90%8E%E7%9A%84%E6%A3%8B%E7%9B%98"><span class="toc-number">2.0.6.</span> <span class="toc-text">打印初始化后的棋盘</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%81%87%E8%AE%BE%E7%8E%B0%E5%9C%A8%E9%BB%91%E6%A3%8B%E4%B8%8B%E6%A3%8B%EF%BC%8C%E5%8F%AF%E4%BB%A5%E8%90%BD%E5%AD%90%E7%9A%84%E4%BD%8D%E7%BD%AE%E6%9C%89%EF%BC%9A-%E2%80%98D3%E2%80%99-%E2%80%98C4%E2%80%99-%E2%80%98F5%E2%80%99-%E2%80%98E6%E2%80%99-%EF%BC%8C"><span class="toc-number">2.0.6.1.</span> <span class="toc-text">假设现在黑棋下棋，可以落子的位置有：[‘D3’, ‘C4’, ‘F5’, ‘E6’]，</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%BB%91%E6%A3%8B%E8%90%BD%E5%AD%90-D3-%E5%88%99%E7%99%BD%E6%A3%8B%E8%A2%AB%E7%BF%BB%E8%BD%AC%E7%9A%84%E6%A3%8B%E5%AD%90%E6%98%AF-D4%E3%80%82"><span class="toc-number">2.0.6.2.</span> <span class="toc-text">黑棋落子 D3 , 则白棋被翻转的棋子是 D4。</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%A8%E7%A4%BA%E9%BB%91%E6%A3%8B"><span class="toc-number">2.0.6.3.</span> <span class="toc-text">表示黑棋</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%90%BD%E5%AD%90%E5%9D%90%E6%A0%87"><span class="toc-number">2.0.6.4.</span> <span class="toc-text">落子坐标</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%93%E5%8D%B0%E7%99%BD%E6%96%B9%E8%A2%AB%E7%BF%BB%E8%BD%AC%E7%9A%84%E6%A3%8B%E5%AD%90%E4%BD%8D%E7%BD%AE"><span class="toc-number">2.0.7.</span> <span class="toc-text">打印白方被翻转的棋子位置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%93%E5%8D%B0%E6%A3%8B%E7%9B%98"><span class="toc-number">2.0.8.</span> <span class="toc-text">打印棋盘</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Game-%E7%B1%BB"><span class="toc-number">2.1.</span> <span class="toc-text">Game 类</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3"><span class="toc-number">3.</span> <span class="toc-text">设计思想</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%92%99%E7%89%B9%E5%8D%A1%E6%B4%9B%E6%96%B9%E6%B3%95-Monte-Carlo-method"><span class="toc-number">3.1.</span> <span class="toc-text">蒙特卡洛方法(Monte Carlo method)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UCT%EF%BC%88%E4%BF%A1%E5%BF%83%E4%B8%8A%E9%99%90%E6%A0%91%E7%AE%97%E6%B3%95%EF%BC%89"><span class="toc-number">3.2.</span> <span class="toc-text">UCT（信心上限树算法）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%89%E6%8B%A9-Selection"><span class="toc-number">3.2.1.</span> <span class="toc-text">选择(Selection)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%93%E5%B1%95-Expansion"><span class="toc-number">3.2.2.</span> <span class="toc-text">拓展(Expansion)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E6%8B%9F-Simulation"><span class="toc-number">3.2.3.</span> <span class="toc-text">模拟(Simulation)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD-Back-Propagation"><span class="toc-number">3.2.4.</span> <span class="toc-text">反向传播(Back Propagation)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MCT%E4%BC%AA%E4%BB%A3%E7%A0%81"><span class="toc-number">3.3.</span> <span class="toc-text">MCT伪代码</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%86%85%E5%AE%B9"><span class="toc-number">4.</span> <span class="toc-text">代码内容</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8A%82%E7%82%B9%E7%B1%BB%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="toc-number">4.1.</span> <span class="toc-text">节点类的定义</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AI%E7%8E%A9%E5%AE%B6%E7%B1%BB%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="toc-number">4.2.</span> <span class="toc-text">AI玩家类的定义</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%BB%E5%8A%A8%E6%A3%8B%E5%AD%90%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">4.2.1.</span> <span class="toc-text">移动棋子的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UCT-search%E7%9A%84%E6%A0%B8%E5%BF%83%E6%A1%86%E6%9E%B6"><span class="toc-number">4.2.2.</span> <span class="toc-text">UCT search的核心框架</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%89%E6%8B%A9%E6%89%A9%E5%B1%95%E7%9A%84%E8%8A%82%E7%82%B9"><span class="toc-number">4.2.3.</span> <span class="toc-text">选择扩展的节点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E5%87%BD%E6%95%B0"><span class="toc-number">4.2.4.</span> <span class="toc-text">扩展函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ucb%E9%80%89%E6%8B%A9%E5%87%BD%E6%95%B0"><span class="toc-number">4.2.5.</span> <span class="toc-text">ucb选择函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E6%A8%A1%E6%8B%9F%E5%AF%B9%E5%BC%88"><span class="toc-number">4.2.6.</span> <span class="toc-text">随机模拟对弈</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%90%91%E4%BC%A0%E6%92%AD"><span class="toc-number">4.2.7.</span> <span class="toc-text">反向传播</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E6%B8%B8%E6%88%8F%E6%98%AF%E5%90%A6%E7%BB%93%E6%9D%9F"><span class="toc-number">4.2.8.</span> <span class="toc-text">判断游戏是否结束</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C"><span class="toc-number">5.</span> <span class="toc-text">实验结果</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9D%E7%BA%A7"><span class="toc-number">5.1.</span> <span class="toc-text">初级</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AD%E7%BA%A7"><span class="toc-number">5.2.</span> <span class="toc-text">中级</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AB%98%E7%BA%A7"><span class="toc-number">5.3.</span> <span class="toc-text">高级</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/05/20/big-model/" title="超大模型加载转换Trick"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="超大模型加载转换Trick"/></a><div class="content"><a class="title" href="/2024/05/20/big-model/" title="超大模型加载转换Trick">超大模型加载转换Trick</a><time datetime="2024-05-20T06:15:55.000Z" title="发表于 2024-05-20 14:15:55">2024-05-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/02/21/MLsys/" title="ML system 入坑指南"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ML system 入坑指南"/></a><div class="content"><a class="title" href="/2023/02/21/MLsys/" title="ML system 入坑指南">ML system 入坑指南</a><time datetime="2023-02-21T07:49:43.000Z" title="发表于 2023-02-21 15:49:43">2023-02-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/02/21/pipeline-paralism/" title="流水线并行论文总结"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="流水线并行论文总结"/></a><div class="content"><a class="title" href="/2023/02/21/pipeline-paralism/" title="流水线并行论文总结">流水线并行论文总结</a><time datetime="2023-02-21T07:49:43.000Z" title="发表于 2023-02-21 15:49:43">2023-02-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/03/11/amp/" title="Mixed Precision Training"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Mixed Precision Training"/></a><div class="content"><a class="title" href="/2022/03/11/amp/" title="Mixed Precision Training">Mixed Precision Training</a><time datetime="2022-03-11T15:47:22.000Z" title="发表于 2022-03-11 23:47:22">2022-03-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/01/23/OPTIMIZER-FUSION/" title="论文解读：OPTIMIZER FUSION - EFFICIENT TRAINING WITH BETTER LOCALITY AND PARALLELISM"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="论文解读：OPTIMIZER FUSION - EFFICIENT TRAINING WITH BETTER LOCALITY AND PARALLELISM"/></a><div class="content"><a class="title" href="/2022/01/23/OPTIMIZER-FUSION/" title="论文解读：OPTIMIZER FUSION - EFFICIENT TRAINING WITH BETTER LOCALITY AND PARALLELISM">论文解读：OPTIMIZER FUSION - EFFICIENT TRAINING WITH BETTER LOCALITY AND PARALLELISM</a><time datetime="2022-01-23T06:53:08.000Z" title="发表于 2022-01-23 14:53:08">2022-01-23</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Fazzie</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi,  welcome  to  my  <a  target="_blank" rel="noopener" href="https://fazzie-key.cool/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    loader: {
      source: {
        '[tex]/amsCd': '[tex]/amscd'
      }
    },
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        addClass: [200,() => {
          document.querySelectorAll('mjx-container:not([display=\'true\']').forEach( node => {
            const target = node.parentNode
            if (!target.classList.contains('has-jax')) {
              target.classList.add('mathjax-overflow')
            }
          })
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>function loadValine () {
  function initValine () {
    let initData = {
      el: '#vcomment',
      appId: 'fxFSTfaEl7rHVkn2JI1Ygud7-gzGzoHsz',
      appKey: 'l5dJNsod5s2Yf9XDYqWuFPwh',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'en',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
    }

    if (true) { 
      initData.requiredFields= ('nick,mail'.split(','))
    }
    
    if (false) {
      const otherData = false
      initData = Object.assign(initData, otherData)
    }
    
    const valine = new Valine(initData)
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><div class="aplayer no-destroy" data-id="7909210123" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>